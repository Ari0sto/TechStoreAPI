<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechStore - Магазин техники</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="logo">TechStore</div>
    
        <div class="header-controls">
            <button onclick="openCart()" class="cart-btn" style="position: relative;">
                🛒 <span id="cart-count" class="cart-badge">0</span>
            </button>
    
            <div id="auth-status"></div>
        </div>
    </header>

    <main class="container">
        
        <div id="admin-panel" style="display:none; background: #f9f9f9; padding: 20px; border-bottom: 2px solid #333;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;">
        <h2>⚙️ Панель Администратора</h2>
        <button onclick="closeAdminPanel()" style="background:#ccc; border:none; padding:5px 10px; cursor:pointer;">Скрыть</button>
    </div>

    <div class="admin-tabs">
        <button id="btn-tab-logs" class="tab-btn" onclick="showAdminTab('logs')" style="display:none;">📜 Логи действий</button>
        <button class="tab-btn active" onclick="showAdminTab('products')">📦 Товары</button>
        <button class="tab-btn" onclick="showAdminTab('orders')">📧 Заказы</button>
        <button class="tab-btn" onclick="showAdminTab('users')">👥 Пользователи</button>
    </div>

    <div id="tab-products" class="admin-tab-content" style="display:block;">
        <button class="btn-primary" onclick="openAddProductModal()" style="margin-bottom: 15px;">+ Добавить товар</button>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Фото</th>
                    <th>Название</th>
                    <th>Цена</th>
                    <th>Склад</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody id="admin-products-table">
                </tbody>
        </table>
    </div>

    <div id="tab-orders" class="admin-tab-content" style="display:none;">
        <button class="btn-primary" onclick="loadAdminOrders()" style="margin-bottom:15px;">🔄 Обновить список</button>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>№</th>
                    <th>Дата</th>
                    <th>User ID</th>
                    <th>Сумма</th>
                    <th>Статус</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody id="admin-orders-table"></tbody>
        </table>
    </div>

    <div id="tab-users" class="admin-tab-content" style="display:none;">
        <button class="btn-primary" onclick="loadAdminUsers()" style="margin-bottom:15px;">🔄 Обновить список</button>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Email</th>
                    <th>Username</th>
                </tr>
            </thead>
            <tbody id="admin-users-table"></tbody>
        </table>
    </div>

    <div id="tab-logs" class="admin-tab-content" style="display:none;">
        <button class="btn-primary" onclick="loadSystemLogs()" style="margin-bottom:15px;">🔄 Обновить</button>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Дата</th>
                    <th>Админ</th>
                    <th>Действие</th>
                    <th>Сущность</th>
                    <th>ID</th>
                    <th>Детали</th>
                </tr>
            </thead>
            <tbody id="admin-logs-table"></tbody>
        </table>
    </div>

</div>

        <h2>Каталог товаров</h2>
        <div class="filters-container" style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
        
            <input type="text" id="search-input" placeholder="🔍 Найти товар..."
                style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; flex-grow: 1;">
        
            <select id="category-filter" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <option value="">Все категории</option>
                <option value="1">Смартфоны</option>
                <option value="2">Ноутбуки</option>
                <option value="3">Телевизоры</option>
                <option value="4">Аксессуары</option>
            </select>
        
            <button onclick="applyFilters()" class="btn-primary" style="padding: 10px 20px;">Найти</button>
        </div>
        
        <div id="products-grid" class="products-grid">
            <p>Загрузка товаров...</p>
        </div>
        
        <div class="pagination-container">
            <button id="btn-prev" onclick="changePage(-1)" disabled>⬅ Назад</button>
        
            <span id="page-info">Стр. 1 из ?</span>
        
            <button id="btn-next" onclick="changePage(1)">Вперед ➡</button>
        </div>

    </main>

    <div id="login-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeLoginModal()">&times;</span>
        <h2>Вход в TechStore</h2>
        <form id="login-form">
            <input type="email" id="login-email" placeholder="Email" required>
            <input type="password" id="login-password" placeholder="Пароль" required>
            <button type="submit" class="btn-primary">Войти</button>
        </form>
        <p id="login-error" style="color:red; display:none;"></p>
    </div>
</div>

    <div id="cart-modal" class="modal">
    <div class="modal-content cart-modal-content">
        <span class="close" onclick="closeCart()">&times;</span>
        <h2>Ваша корзина</h2>
        
        <div id="cart-items-container">
            <p>Корзина пуста</p>
        </div>

        <div class="cart-footer">
            <div class="cart-total-row">
                <span>Итого:</span>
                <span id="cart-total-price" class="total-price">0 ₴</span>
            </div>
            <button class="btn-primary" onclick="checkout()">Оформить заказ</button>
        </div>
    </div>
</div>

<div id="product-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeProductModal()">&times;</span>
        <h2 id="modal-product-title">Товар</h2>
        
        <form id="product-form">
            <input type="hidden" name="Id" id="prod-id">

            <div class="form-group">
                <input type="text" name="Name" id="prod-name" placeholder="Название" required style="width:100%">
            </div>
            
            <div class="form-group">
                <input type="number" name="Price" id="prod-price" placeholder="Цена" required>
                <input type="number" name="Stock" id="prod-stock" placeholder="Склад" required>
            </div>

            <div class="form-group">
                <select name="CategoryId" id="prod-cat" required style="width:100%; padding:8px;">
                    <option value="" disabled selected>Выберите категорию</option>
                    <option value="1">Смартфоны</option>
                    <option value="2">Ноутбуки</option>
                    <option value="3">Телевизоры</option>
                    <option value="4">Аксессуары</option>
                </select>
            </div>

            <div class="form-group">
                <input type="text" name="Description" id="prod-desc" placeholder="Описание" style="width:100%">
            </div>

            <div class="form-group">
                <label>Фото:</label>
                <input type="file" name="Image" id="prod-img">
            </div>

            <button type="submit" class="btn-save" style="width:100%">Сохранить</button>
        </form>
    </div>
</div>

    <div id="register-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close" onclick="closeRegisterModal()">&times;</span>
            <h2>Регистрация</h2>
            <form id="register-form">
                <div class="form-group">
                    <input type="email" id="reg-email" placeholder="Email" required style="width:100%">
                </div>
                <div class="form-group">
                    <input type="password" id="reg-password" placeholder="Пароль" required style="width:100%">
                </div>
                <div class="form-group">
                    <input type="password" id="reg-confirm" placeholder="Повторите пароль" required style="width:100%">
                </div>
                <p id="reg-error" style="color:red; display:none;"></p>
                <button type="submit" class="btn-save" style="width:100%">Зарегистрироваться</button>
            </form>
        </div>
    </div>

    <div id="my-orders-modal" class="modal">
    <div class="modal-content" style="max-width: 95%; width: 1200px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2>📦 Мои заказы</h2>
            <span class="close" onclick="closeMyOrdersModal()">&times;</span>
        </div>
        
        <table class="admin-table" style="margin-top:20px;">
            <thead>
                <tr>
                    <th>№</th>
                    <th>Дата</th>
                    <th>Сумма</th>
                    <th>Статус</th>
                    <th>Товары</th>
                </tr>
            </thead>
            <tbody id="my-orders-table">
                </tbody>
        </table>
    </div>
</div>

    <script src="script.js"></script>
</body>
</html>